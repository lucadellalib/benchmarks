from datasets import load_dataset, Audio
from transformers import EncodecModel, AutoProcessor

# dummy dataset, however you can swap this with an dataset on the ðŸ¤— hub or bring your own
librispeech_dummy = load_dataset("hf-internal-testing/librispeech_asr_dummy", "clean", split="validation")

# load the model + processor (for pre-processing the audio)
model = EncodecModel.from_pretrained("facebook/encodec_24khz")
processor = AutoProcessor.from_pretrained("facebook/encodec_24khz")

# cast the audio data to the correct sampling rate for the model
librispeech_dummy = librispeech_dummy.cast_column("audio", Audio(sampling_rate=processor.sampling_rate))
audio_sample = librispeech_dummy[0]["audio"]["array"]

import torch
import speechbrain
from speechbrain.lobes.models.huggingface_transformers.encodec import Encodec

codec = Encodec(
    source="facebook/encodec_24khz",    # Only the 24kHz version supports mono audio
    save_path="prova",
    sample_rate=24000,
    bandwidth=1.5,
    flat_embeddings=False,
    freeze=True,
    renorm_embeddings=False,
)

codec.eval()
noisy_sig = torch.as_tensor(audio_sample)[None, None]
in_tokens, in_embs = codec.encode(
    noisy_sig[:, 0], torch.as_tensor([1.0])
)

in_tokens2, in_embs = codec.encode(
    noisy_sig[:, 0], torch.as_tensor([1.0])
)

print((in_tokens == in_tokens2).all())

ref = [
62, 62,580,913,835, 62,544,424,835,  62 ,544,424,835, 62, 544 ,424,835,408,544,544,835 ,408,544,544,835,408,544,424,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518 ,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408,544,518, 835 ,408,544,518,835,408,518,518, 835 ,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518 ,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408,544,518 ,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835 ,408,544,518,835,408 ,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835 ,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835 ,408,544,518,835,408,544,518,835,408,544,518,835,408,544, 518 ,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518, 835 ,408,544,518,835,408,544,518,835,408,544,518 , 835 ,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518, 835 ,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518 ,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518 ,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835 ,408,544,518,835,408,544,518, 835 ,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408 ,544 ,518,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835 ,408,544,518, 835 ,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408,544,518 ,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518 ,835,408,544,518, 835 ,408,544,518,835,408,544,518 , 835 ,408,544,518,835,408,544,518,835,408,544,518, 835 ,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518 ,835,408,544, 518 ,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408 ,544,518,835,408 ,544,518,835 ,408,544,518,835 ,408,544,518, 835 ,408,544,518,835,408,544,518, 835 ,408,544,518,835,408,544 ,518,835 ,408,544,518,835,408,544,518,835,408,544 ,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518,835,408,544,518
]

from utils import play_waveform
hyp_tokens = torch.as_tensor(ref).reshape(-1, 2, 2)
rec_sig = codec.decode(hyp_tokens[None][..., 0], torch.as_tensor([1.0]))[0, 0]
print(rec_sig.shape)
play_waveform(rec_sig.detach().cpu(), 24000, interactive=True, output_file="ref.wav")
breakpoint()
print(rec_sig.sum())

rec_sig = codec.decode(hyp_tokens[None], torch.as_tensor([1.0]))[0, 0]
print(rec_sig.sum())

# pre-process the inputs
inputs = processor(raw_audio=audio_sample, sampling_rate=processor.sampling_rate, return_tensors="pt")

# explicitly encode then decode the audio inputs
encoder_outputs = model.encode(inputs["input_values"], inputs["padding_mask"])
audio_values = model.decode(encoder_outputs.audio_codes, encoder_outputs.audio_scales, inputs["padding_mask"])[0]

# or the equivalent with a forward pass
audio_values = model(inputs["input_values"], inputs["padding_mask"]).audio_values

# you can also extract the discrete codebook representation for LM tasks
# output: concatenated tensor of all the representations
audio_codes = model(inputs["input_values"], inputs["padding_mask"]).audio_codes

audio_codes1 = model(inputs["input_values"], inputs["padding_mask"]).audio_codes

audio_codes2 = model(inputs["input_values"], inputs["padding_mask"]).audio_codes

(audio_codes == audio_codes1).all()

(audio_codes == audio_codes2).all()

ref = [
717, 424, 738, 277, 738, 740, 738, 87, 408, 277, 835, 277, 738, 277, 738, 87, 738, 913, 106, 277, 1011, 747, 472, 648, 408, 544, 475, 302, 475, 277, 475, 424, 475, 87, 475, 277, 475, 424, 472,  43, 475, 302, 887, 544, 472,  43, 395, 580, 472, 937, 475, 937, 395, 740, 475, 729, 475, 937, 106, 277, 106, 424, 876, 913, 106, 913, 106, 302, 106, 277, 408, 302, 738, 937, 408, 424, 738, 740, 408, 424, 408, 518, 738, 544, 408, 424, 408, 424, 738, 740, 428,  64, 428, 577, 772, 443, 501, 559, 583, 121, 255, 975, 255, 828, 751, 870, 751, 777, 136, 942, 1004, 791, 939, 592, 112, 367, 871, 564, 834, 651, 408, 601, 865, 740, 717, 913, 428, 994, 393, 777, 820, 558, 841, 909, 230, 486, 189, 855, 846, 469, 358, 559, 1009, 288, 695, 766, 222, 323, 747, 296, 213, 346, 128, 582, 162, 405, 240, 296,  11, 230, 984, 575, 182, 431, 457, 166, 224, 924, 321, 533, 224, 991, 321, 991, 604, 564, 835, 277, 935, 740, 323, 648, 255, 359, 432, 729, 604, 533, 699, 646, 881, 417, 203, 186, 886, 392, 886, 784, 112, 116, 457, 592, 491, 580, 475, 630, 176, 924, 709, 956, 160, 993 , 999, 857, 410, 200,  62, 937, 408, 937, 876, 740, 645, 153, 392,  69, 747, 197, 747, 467, 747, 651, 1011, 245, 834, 567, 208, 870, 865, 937, 408, 87, 310, 953, 751, 498, 967 , 870,  20, 417, 457, 492, 604, 1007, 160, 831, 709, 747, 709, 747, 709, 544, 879, 580, 651, 580, 457, 297, 1019, 888, 738, 765, 408, 937, 408, 937, 835, 937, 133, 646, 85, 153, 796, 711, 372, 346, 198, 909, 683, 502, 683, 346, 683, 346, 942, 945, 976, 564, 699, 870, 699, 870, 321, 870, 136, 392, 967, 1007, 983, 228, 983, 690, 876, 571, 835 , 1023, 835, 200, 133, 1023, 395, 841, 176, 1002, 472, 974, 583, 463, 688, 417,  275 ,  856 , 658, 981, 862, 205, 457 , 297, 604, 752,  62, 765, 780, 913, 408, 913, 999, 961, 472, 1023, 472, 1023, 176, 652, 709, 913, 709, 646, 395, 857, 976, 192, 923, 349, 967, 367, 432, 1007, 430, 601, 475, 404, 475, 43, 475,  87, 475, 277, 133, 200, 408, 424, 699, 721, 203, 880, 428,  69,  11, 766, 862, 984, 275 , 418, 1008, 228, 862, 228 , 1022, 748, 1011, 580, 457, 580, 967, 580 , 457, 372, 224, 888, 321, 1007, 224, 228, 321, 228, 1022, 653, 321, 228, 224, 580, 879, 765, 224, 646, 432, 765, 604, 404, 432, 765 , 491, 564, 1017, 687, 738, 740, 738,  87, 876, 87, 1017,  302 ,  661 , 87, 709, 913, 709, 168, 709, 87, 709, 277, 709, 277, 339, 857, 463, 87, 855, 133, 855, 277, 780, 424, 738, 913, 738, 424, 1017,  87, 738, 518


]

rec = [
717 ,424 ,738 ,277 ,738 ,740 ,738 ,87 ,408 ,277 ,835 ,277 ,738 ,277 ,738 ,87 ,738 ,913 ,106 ,277 ,1011 ,747 ,472 ,648 ,408 ,544 ,475 ,302 ,475 ,277 ,475 ,424 ,475 ,87 ,475 ,277 ,475 ,424 ,472 ,43 ,475 ,302 ,887 ,544 ,472 ,43 ,395 ,580 ,472 ,937 ,475 ,937 ,395 ,740 ,475 ,729 ,475 ,937 ,106 ,277 ,106 ,424 ,876 ,913 ,106 ,913 ,106 ,302 ,106 ,277 ,408 ,302 ,738 ,937 ,408 ,424 ,738 ,740 ,408 ,424 ,408 ,518 ,738 ,544 ,408 ,424 ,408 ,424 ,738 ,740 ,428 ,64 ,428 ,577 ,772 ,443 ,501 ,559 ,583 ,121 ,255 ,975 ,255 ,828 ,751 ,870 ,751 ,777 ,136 ,942 ,1004 ,791 ,939 ,592 ,112 ,367 ,871 ,564 ,834 ,651 ,408 ,601 ,865 ,740 ,717 ,913 ,428 ,994 ,393 ,777 ,820 ,558 ,841 ,909 ,230 ,486 ,189 ,855 ,846 ,469 ,358 ,559 ,1009 ,288 ,695 ,766 ,222 ,323 ,747 ,296 ,213 ,346 ,128 ,582 ,162 ,405 ,240 ,296 ,11 ,230 ,984 ,575 ,182 ,431 ,457 ,166 ,224 ,924 ,321 ,533 ,224 ,991 ,321 ,991 ,604 ,564 ,835 ,277 ,935 ,740 ,323 ,648 ,255 ,359 ,432 ,729 ,604 ,533 ,699 ,646 ,881 ,417 ,203 ,186 ,886 ,392 ,886 ,784 ,112 ,116 ,457 ,592 ,491 ,580 ,475 ,630 ,176 ,924 ,709 ,956 ,160 ,993 ,999 ,857 ,410 ,200 ,62 ,937 ,408 ,937 ,876 ,740 ,645 ,153 ,392 ,69 ,747 ,197 ,747 ,467 ,747 ,651 ,1011 ,245 ,834 ,567 ,208 ,870 ,865 ,937 ,408 ,87 ,310 ,953 ,751 ,498 ,967 ,870 ,20 ,417 ,457 ,492 ,604 ,1007 ,160 ,831 ,709 ,747 ,709 ,747 ,709 ,544 ,879 ,580 ,651 ,580 ,457 ,297 ,1019 ,888 ,738 ,765 ,408 ,937 ,408 ,937 ,835 ,937 ,133 ,646 ,85 ,153 ,796 ,711 ,372 ,346 ,198 ,909 ,683 ,502 ,683 ,346 ,683 ,346 ,942 ,945 ,976 ,564 ,699 ,870 ,699 ,870 ,321 ,870 ,136 ,392 ,967 ,1007 ,983 ,228 ,983 ,690 ,876 ,571 ,835 ,1023 ,835 ,200 ,133 ,1023 ,395 ,841 ,176 ,1002 ,472 ,974 ,583 ,463 ,688 ,417 ,275 ,856 ,658 ,981 ,862 ,205 ,457 ,297 ,604 ,752 ,62 ,765 ,780 ,913 ,408 ,913 ,999 ,961 ,472 ,1023 ,472 ,1023 ,176 ,652 ,709 ,913 ,709 ,646 ,395 ,857 ,976 ,192 ,923 ,349 ,967 ,367 ,432 ,1007 ,430 ,601 ,475 ,404 ,475 ,43 ,475 ,87 ,475 ,277 ,133 ,200 ,408 ,424 ,699 ,721 ,203 ,880 ,428 ,69 ,11 ,766 ,862 ,984 ,275 ,418 ,1008 ,228 ,862 ,228 ,1022 ,748 ,1011 ,580 ,457 ,580 ,967 ,580 ,457 ,372 ,224 ,888 ,321 ,1007 ,224 ,228 ,321 ,228 ,1022 ,653 ,321 ,228 ,224 ,580 ,879 ,765 ,224 ,646 ,432 ,765 ,604 ,404 ,432 ,765 ,491 ,564 ,1017 ,687 ,738 ,740 ,738 ,87 ,876 ,87 ,1017 ,302 ,661 ,87 ,709 ,913 ,709 ,168 ,709 ,87 ,709 ,277 ,709 ,277 ,339 ,857 ,463 ,87 ,855 ,133 ,855 ,277 ,780 ,424 ,738 ,913 ,738 ,424 ,1017 ,87 ,738 ,518
]


pred = [
    408, 859, 738, 87, 738,  87, 133, 646, 133, 277, 738 , 740, 738,  87, 738,  87, 133, 277,  133 ,  277 , 833, 806, 635, 1007,  106 ,   87 , 475, 544, 475, 1007, 537, 277, 537, 740, 537,  87, 537, 277, 537, 277, 537,  87, 537, 580, 537, 43, 537, 857, 537, 87, 537, 200, 537, 580, 935, 277, 73, 864 , 537, 1007,  677 ,   87 , 537, 729, 537, 277, 537, 277, 537, 277, 666, 870, 887,  87, 779, 460, 133 , 277, 738, 277, 738,  87, 738, 87, 126 ,  87, 791, 302, 676, 577, 535, 589, 998, 869, 324, 738, 457, 460, 709, 493, 709, 747 , 835, 747, 709, 747, 176, 348, 709, 277, 819, 277, 819, 741, 15, 449, 998, 347, 565, 375, 976, 564, 976, 564, 976, 564, 976, 348, 751, 898, 961, 323, 869, 401, 568, 291, 954, 347, 413, 869, 466, 649, 504, 869, 82, 949, 834, 683, 976, 806 , 466, 967, 892, 792, 320, 347, 808, 116, 432, 405, 491,  85, 491, 741, 751, 960, 923, 349, 255, 697, 321, 229, 676, 601, 438, 984, 438, 956, 160, 926, 160, 926, 160, 926, 798, 747, 523, 460, 903, 650, 358, 1, 694, 559, 650, 540 , 779, 801, 865, 589,  62,  6 , 855,  6 , 855,  6 , 347, 371, 85, 347, 344, 617, 725, 451, 143, 399, 651, 144, 687, 870, 224, 987, 321, 741, 604, 888, 855, 350, 62, 741, 850, 153, 725, 248, 182, 668, 695, 137, 793, 708, 501, 174, 862, 598, 679, 6, 613, 317, 690, 269, 259, 533, 185, 252, 224, 371, 491, 177, 537, 898, 537, 956, 176, 1002, 709, 1002, 176, 926, 176, 277, 537, 1007, 404, 993, 784, 214, 928, 343, 928, 822, 3, 301, 3, 301, 936, 116, 881, 116, 921,  69, 942, 564, 751, 987, 160, 229, 160, 877, 160, 404, 373, 201, 907, 710, 224, 443, 1017, 993, 865, 740, 738,  87, 738, 302, 738 , 277, 213, 921, 106, 969, 393, 740, 734, 639, 392, 582, 683, 86, 658, 405, 491, 870, 751, 392, 651, 392, 687, 870, 224, 920, 321, 959, 694, 174, 694, 1014, 432, 888, 1019, 564, 62, 277,   62 ,  740 , 738, 87, 133, 277, 203, 791, 751, 199, 264, 179, 57, 702, 796, 711, 502, 915, 407, 504, 906, 348, 868, 422, 923, 304, 651, 245, 982, 144, 679, 441, 862,  71, 604, 787, 709 , 669, 176, 1023, 409, 791, 291, 947, 755, 252, 694, 174, 432, 765, 835, 1023, 339, 1023, 395, 277 , 176, 994, 176, 1002, 537, 277, 537, 740, 126, 580, 688, 346, 730, 136, 392, 338, 688, 460, 348, 996, 950, 252, 582, 174, 950, 252, 658, 174, 961, 998, 906, 626, 699, 43, 276, 43, 25, 741, 148, 43, 148, 646, 148, 646, 798, 652,  176 ,  646 , 160, 993, 709, 747, 865, 993, 780, 277, 738, 87, 1017, 302, 133, 277, 63, 993, 409 , 460, 808, 417, 645, 174, 255, 987, 871, 405, 890, 180, 651, 782, 540, 164, 944, 227, 890, 417, 360, 690, 160, 765, 709, 646, 160, 926, 160, 1002, 1011, 648, 656, 683, 695, 27, 309, 27, 695, 27, 501, 438, 656, 836, 451, 695, 291, 757, 598, 800, 961, 760, 347, 372, 430, 995, 582, 921, 465, 607, 3, 564, 699,  43, 160, 177, 160, 646, 798, 956, 404, 282, 780, 277, 738, 277, 63, 740, 794, 652, 25, 81, 328, 536, 699, 460, 876, 765, 62,  87,  62 , 277, 738, 277, 420, 713, 276, 198, 197, 703, 796, 651, 833, 527, 491, 282, 1019, 227, 432, 114, 457, 770, 431, 54, 984, 701, 491, 984, 1019, 564, 62, 404, 62, 740, 738, 277, 876, 740,  395 ,   87 , 133, 277, 627, 861, 725, 554, 162, 444, 162, 307, 162, 269, 162, 671, 793, 995, 573, 6, 983, 67, 722, 45, 155, 708, 868, 76, 862, 252, 679, 743, 862, 864, 679, 1014, 533, 591, 224, 580, 491, 363, 651, 920, 81, 460, 666, 708, 430, 296, 651, 228, 431, 668, 793, 229, 573, 668, 182, 1014, 136, 931, 738, 765,  62, 700, 133, 516, 738, 740, 1017, 302, 738, 277, 984, 713, 687, 666, 224, 144, 651, 392, 431, 632, 348, 564, 182, 739, 658, 47, 950, 418, 983, 467, 255, 399, 321, 870, 687, 870, 224, 870, 699, 417, 961, 713, 747, 854, 136, 392, 751, 216, 57, 132, 921, 703, 502, 657, 921, 703, 255, 373, 942, 619, 432, 359, 604 , 564, 432, 765, 604, 564, 432, 765, 1022, 648, 890, 214, 288, 931, 793, 405, 182, 505, 162, 520, 428, 708, 679, 546, 213, 417, 531, 245, 431, 598, 694, 460, 431, 869, 502, 745, 23, 418, 699, 651, 604, 533, 1017, 765,  62, 277, 835,  87,  25,  87, 25, 277, 103, 277, 491, 296, 588, 998, 327, 674, 575, 702, 222, 174, 162, 367, 679, 89, 690, 685, 690, 67, 679, 546, 862, 221, 901, 245, 573, 221, 862, 122, 961, 748, 291, 417, 1019, 793,  62, 363, 62, 277, 876, 740, 753, 577, 734, 501, 112, 229, 747, 116, 372, 748, 926, 228, 747, 116, 747, 748, 862, 585, 573, 668, 862, 668, 573, 89, 862, 416, 679, 633, 457, 298, 699, 844, 224, 439, 875, 870, 321, 259, 224, 964, 491, 458, 408, 302, 335, 994, 433, 948, 865, 993, 780, 277, 738, 87, 1017, 302, 133, 277, 887, 277, 537,  87, 537, 277, 666, 580, 537, 200, 537, 277, 537,  87, 276, 857, 887, 277, 537,  87, 779, 302, 779, 277, 779, 43, 779,  43 , 475, 277, 738 ,  87, 133, 277, 133, 277, 738, 87, 1017, 302, 133, 277, 160, 926, 160, 926, 160, 277, 176, 740, 770, 721, 560, 460, 642, 116, 457, 392, 530, 259, 208, 351, 976, 265 , 709, 747, 160, 348, 148, 747, 103, 974, 151, 241, 472, 1002, 835 , 747, 475,  87, 923, 858, 556, 426, 878, 469, 903, 711, 99, 107, 886, 536, 430, 533, 1019, 227, 790, 132, 57, 703, 57, 703, 1008, 132, 255, 926, 255, 870, 699, 657, 699, 404, 738, 601, 62, 544,  62, 277, 738, 277, 203, 861, 835, 969, 255, 858, 182, 373, 796, 368, 939, 702, 407, 884, 407, 770, 407, 116, 407, 285, 502, 121, 651, 460, 651, 392, 583, 394, 432, 986, 1019, 700, 806, 229, 984, 884, 755, 27, 501, 685, 501, 444, 222, 264, 162, 245, 695, 690, 240, 252, 679, 166, 1011, 671, 958, 216, 855, 996, 523, 497, 738, 6, 860, 359, 604, 577, 344, 351, 291, 582, 987, 663, 694, 137, 694, 227, 788, 965, 687, 460, 224, 564, 651, 392, 321, 565, 687, 529, 136, 582, 651, 496, 687, 71, 1008, 920, 694, 628, 983, 460, 23, 653, 23, 809, 23, 787, 432 , 643,  62, 302, 62, 277, 738,  87, 1017, 302, 415, 982, 339, 1007, 176, 200 , 438, 646, 709, 747, 160, 277, 798, 652, 408, 87, 433, 974, 237, 443, 106, 993, 780, 277, 835, 277, 709, 747, 368, 492, 432, 959, 837, 418, 950, 708, 253, 931, 862, 221, 143, 836, 982, 633, 321, 144, 224, 904, 875, 462, 310, 252, 136, 664, 862, 317, 23, 998, 906,  6 , 1008, 52, 961, 674, 240, 180, 793, 417, 573, 66, 182, 367, 984,  89, 182, 812, 155, 668, 293, 708, 679, 546, 982, 228, 1008, 921, 1022, 679, 457, 520, 1011, 571, 1022, 580, 875, 580, 699, 404, 604, 700, 133, 601, 475, 277, 738, 87, 133, 277, 876, 740, 126,  87, 133, 302, 738, 277, 738, 87
]

# 26.99
#ref = [
#    409, 741, 739, 88, 127, 741, 1020, 647, 134, 278, 134, 647, 127, 647, 127,  88, 409, 303, 134, 278,   739, 278, 127, 647, 739,   88 ,  1018, 303, 836, 278, 134, 914, 836, 842, 739, 303, 127, 647, 1018, 914, 566, 278, 538, 278, 538, 898, 538, 88, 277, 206, 667, 1008, 538, 44, 538, 965, 936, 741, 277,  88, 538, 938, 473, 278, 473, 44, 127,  1008,  877 , 88, 836, 278, 134, 647, 1018, 914, 739, 938,   396, 278, 820, 961, 177, 88, 161, 278, 439, 647, 161, 741, 439, 472, 822, 653, 678, 631, 747, 918, 335, 793, 857, 793, 699, 865, 562, 793, 256, 871, 968, 821, 209, 871, 1011, 714, 322, 498, 238, 236, 575, 711, 161, 653, 161, 927, 396, 5, 781, 278, 877, 88, 127, 88, 628, 973, 1011, 776, 315, 779, 56, 631, 557, 433, 586, 857, 851, 298, 432, 997, 962, 982, 927, 528, 432, 528, 984, 749, 652, 228, 322, 1015, 688, 691, 924, 807, 1009, 704, 1012, 230, 908, 186, 752, 905, 256, 786, 70, 141, 913, 418, 785, 297, 589, 228, 613, 652, 932, 308, 256, 949, 820, 949, 161, 185 , 439, 278, 820, 931, 877, 994, 739, 211, 134, 647, 134, 303,  63, 425, 410, 217, 603, 899, 941, 873, 26, 686, 463, 376, 540, 461, 904, 537, 557, 793, 917, 298, 408, 472, 907, 953, 466, 608, 256, 427, 433, 270, 1020, 534, 835, 405, 409, 602, 409, 741, 754, 88, 677, 741 , 70, 987, 927, 461, 423, 997, 731, 347, 349, 786, 1019, 423, 349, 270, 217, 686, 684, 117, 393, 70, 217, 347, 234, 565, 129, 246, 183, 685, 748, 68,  63, 830, 697, 664, 134, 229 , 340, 741, 678, 493, 1018, 990, 781, 278, 1018, 858, 161, 545, 149, 44, 538, 44, 972, 44, 345, 461, 869, 347, 700, 565, 409, 741, 63,  88, 409, 303, 134, 938, 739, 938, 739, 88, 328, 807, 394, 392, 754, 970, 393, 583, 349, 620, 479, 198, 962, 932, 863, 432, 869, 28, 183, 76, 458, 777, 700, 1008, 464, 699, 122, 649, 410, 995, 149, 748, 464, 422 , 348, 871, 605, 994, 70, 461, 137, 461, 700, 246, 688, 145, 968, 246, 458, 691, 1009, 373, 985, 335, 225, 581, 877, 115, 866, 88, 739, 303, 134, 860,  64, 994, 96, 95, 476, 88, 880, 724, 323, 48, 183, 145, 458, 145, 225, 565, 322, 889, 225, 145, 433, 766, 476, 701, 836, 914, 739, 88, 1018, 88, 336, 807, 324, 392, 688, 569, 680, 258, 431, 987, 700, 694, 688, 813, 1009, 373, 869, 90, 652, 837, 137, 145, 322, 834, 225, 878, 880, 766, 127 , 520, 127, 929, 1018, 303, 464, 278, 409, 741, 739,  88, 127, 647, 877, 860, 134, 303, 836, 278, 1020, 278, 739, 741, 127, 741, 1018, 88, 134, 938, 134, 278, 127, 647, 127, 938, 836, 278
#]

#pred = [
#    409,  88, 739, 88, 739, 741, 739 ,  88, 134, 278, 134, 278, 739,  88, 739, 938, 409, 278, 134, 278,  134 ,   88 , 739, 278, 739, 278, 739,   303, 134, 278, 134, 278, 739, 278, 739, 303, 739, 278, 1018,  88, 566, 929, 538, 278, 538, 898, 538, 88, 277, 206, 667, 581 , 538, 44, 538, 965, 936, 741, 277, 581, 538, 278, 780, 899, 473, 44, 476,   88, 127, 278, 409, 914, 739 , 278, 739,  88,  739 ,   88 , 396, 278, 820, 961, 177, 88, 161, 278, 439, 647, 161, 647, 439, 472, 822, 653, 678, 631, 747, 918, 335, 793, 857, 793, 699, 865, 562, 793, 256, 871, 968, 821, 209, 871, 1011, 714, 322, 498, 238, 236, 575, 711, 161, 653, 161, 927, 781, 5, 781,  88, 739, 88, 127, 88, 628, 649, 1011, 776, 315, 779, 56, 631, 557, 433, 586, 857, 851, 298, 432, 997, 962, 982, 927, 528, 432, 528, 984, 181, 652, 228, 322, 1015, 688, 691, 924, 807, 1009, 704, 1012, 230, 908, 186, 752, 905, 125, 530, 70, 141, 913, 418, 785, 297, 589, 228, 613, 652, 932, 308, 256, 949, 820, 949, 161, 1024, 439, 278, 177, 161, 476, 994, 739,  88, 739, 278, 134, 303, 409, 938, 410, 217, 603, 899, 941, 810, 26, 686, 463, 376, 540, 461, 904, 537, 557, 793, 917, 298, 408, 472, 907, 953, 466, 608, 256, 427, 433, 270, 1020, 534, 835, 405, 739, 860,  63, 741, 754, 88, 677, 1003, 70, 960, 927, 461, 423, 997, 731, 347, 349, 786, 1019, 423, 349, 270, 217, 686, 684, 117, 393, 70, 217, 347, 234, 528, 129, 246, 183, 685, 748, 68, 409,  88, 697, 664, 134, 1008, 340, 278, 678, 493, 476 , 990, 866, 278, 134 , 858, 161, 741, 149, 44, 538, 44, 972, 44, 345, 461, 869, 347, 700, 565,  63, 766, 63, 741,  63, 278, 134, 278, 836, 278, 739, 88, 328, 807, 371, 283, 754, 970, 393, 583, 349, 620, 479, 198, 735, 711, 863, 432, 869, 28, 183, 76, 458, 777, 700, 1008, 464, 699, 781, 647, 410, 995, 149, 748, 464, 1024, 348, 994, 605, 994, 70, 461, 137, 461, 700, 565, 688, 145, 968, 246, 688, 246, 1009, 373, 985, 335, 225, 581, 877, 115,  63, 88, 409, 303, 134, 278, 793, 861, 96, 95, 127, 88, 473, 724, 323, 48, 183, 145, 458, 145, 225, 565, 322, 889, 225, 889, 433, 766, 877, 701,  63, 914, 409, 88, 739 , 88, 336, 807, 324, 278, 688, 569, 680, 258, 431, 670, 700, 694, 688, 364, 1009, 373, 869, 90, 652, 837, 137, 145, 322, 834, 225, 878, 880, 766, 1020, 520, 134, 278, 1018, 701, 464, 938, 409,  88, 739, 303, 739,  88, 739,  88, 134, 303, 134,  88, 739 , 278, 739, 741, 739, 741, 739 , 88, 134,  88, 134, 741, 739,  88, 739,  88, 739, 278
#]


#50.56 TER
#ref = [
#409, 303, 877, 545, 836,   88, 134, 545, 134, 914, 1020,  88, 836,   88, 836, 938, 836, 278, 836, 303, 836, 278, 739, 545, 739, 425, 1018,  88, 836, 938, 836, 303, 836, 278, 739, 519, 877, 88, 739, 914, 739, 278, 134, 647, 739, 545, 739, 914, 739, 425, 739, 938, 836, 278, 836, 914, 739, 741, 739, 278, 877, 938, 739,  88, 739, 303, 409, 938, 134,  647 ,  877 , 278, 127, 545, 836, 914, 134, 647, 409, 938, 877, 278, 538, 653, 464,  581 ,  464 , 201, 149, 653, 149, 647, 161, 134, 161, 653, 161, 975, 149, 283, 240, 178, 556,  73, 170,  40, 981, 193, 75, 631, 907, 779, 433, 679, 866, 773, 739,  88, 739, 278, 836, 278, 739, 938, 1015, 939, 575, 899, 149,  957 ,  161 , 653, 161, 975, 149, 349, 149, 653, 566, 686, 411 , 425, 409, 914, 409, 914, 409, 741, 739, 914, 127, 647,   538, 938, 637, 948, 582, 444, 767, 656, 585, 68, 13, 36, 253, 778, 613, 933,  34, 427, 987, 337, 973, 703, 81, 73, 992, 706, 954, 1015, 673, 1015, 677, 352, 149, 830, 149, 134, 149, 349, 149, 134, 992, 412, 988, 180, 614, 816, 524, 956, 229, 237, 26,   422, 177, 1003, 710, 975, 799,  5  , 177, 269, 799, 876, 799, 876, 799,  161 ,  799 , 1003, 74, 38, 92, 694, 556, 525, 644, 73, 414, 664, 349,  73, 821, 298, 587, 677, 812, 773 , 765, 813, 277, 364, 489, 910, 255, 5, 146, 186 , 146, 186 , 146, 186,   146, 647, 149, 242, 149, 242, 149,  777 ,  146 , 647, 149, 975, 149, 975, 710, 975, 409, 649, 866, 994, 144, 836, 192, 918, 752, 356, 345,  35, 938, 1004,  34, 698, 576, 68, 924, 535, 415, 525, 922, 93, 922, 601, 922, 499, 812, 43, 229, 484, 1018, 652, 63, 914, 409, 303, 877,  88, 1018, 303, 138, 219, 408, 357, 480, 116, 728, 667, 808, 1018, 466, 488, 728, 667, 907, 652 , 907, 850, 728, 832, 652, 532, 907, 389, 345, 352, 466, 382, 808, 773, 752, 503, 1002, 227, 374, 416, 149, 1024, 575, 832, 161, 1024, 161, 653, 149, 349, 149, 653, 149, 914, 464, 201, 538, 994, 473, 368, 409, 994, 1020, 748, 739, 303, 107, 278, 739, 914, 739, 364, 409, 278, 739, 519, 836, 278, 127,  88, 134,  938 ,  107 , 278, 127, 88, 134, 647, 739, 278, 127, 647,   134, 649, 739, 278, 877, 88, 134, 647, 739, 741, 127, 938, 134, 303, 836, 278, 127, 647, 836, 88, 1018, 278, 409, 278, 122, 425, 405, 914, 476, 914, 739, 741, 409, 303, 836, 278, 396, 545, 473, 201, 458, 724, 864, 986, 582, 77, 199, 991, 796, 46, 281,  56, 644, 123, 467, 318, 505, 933, 756, 193, 34, 438, 917, 23, 725, 431, 836 , 741,  26, 185, 104, 183 , 678, 795, 799, 184, 361, 349, 877, 509, 127, 201, 134, 278, 710, 741, 161, 649, 439, 278, 820, 741 , 87, 863, 865, 108, 938, 887, 589, 697, 466, 473, 24, 472, 710, 950, 923, 701, 409, 943, 127, 975, 739, 649, 500, 498, 64, 653, 620, 183, 575, 242, 149, 858, 575, 985, 464, 748, 836, 653, 748, 319, 1023, 815, 929, 360, 785, 940, 699, 299, 1021, 940, 370, 864, 34, 504, 502, 940, 401, 940, 502, 506, 199, 336, 217, 601, 281, 380,  34, 664, 877, 652, 1018, 987, 877, 278, 877, 88, 1018, 303, 662,  88, 146, 387 , 149, 169 , 149, 349, 149, 472, 434, 201, 876, 107, 317, 404, 809, 68, 34, 525, 943, 956, 968, 504, 492, 544,   725, 786, 877 , 408,  63 , 938, 781, 278, 739, 914, 739,  303 ,  107 , 278,  409 ,  519 , 739, 860, 739, 88, 739, 303,   1009, 862, 192, 940, 256, 940, 752, 68, 1001, 454, 1001, 152, 192, 963, 950, 106, 425, 352, 988, 493,  34, 644, 816, 778, 466, 778, 700, 922,  877 , 1018, 866,  88, 134, 647,  26, 861, 146, 242, 146, 1024, 146, 520, 489, 269, 104, 425, 277, 145, 571, 825, 408, 684, 503, 660, 907, 499, 152, 352, 466, 812, 652, 650, 531, 352, 652, 236, 137, 336, 584, 518, 688, 821, 152, 219, 907, 431, 24, 790, 503, 106, 978, 438, 584, 23, 374, 850, 149, 860, 161, 711, 161, 711 , 149, 37, 149, 647, 464, 653, 149, 385, 26, 581, 134, 581,   739, 581, 127, 647, 134, 647, 877,   278, 127, 914, 739, 914, 134, 647, 739, 425, 739, 914, 1018, 647, 409, 741, 739, 88, 739, 545, 836, 278, 739, 938, 739, 741, 739, 88, 739, 938, 134, 647, 134, 647, 877,  741 ,  877 , 88, 739, 278, 739, 278, 409, 278, 836, 938, 836, 425, 538, 483, 739, 88, 107, 303,  571 ,  213 , 60, 154, 652, 152, 312,  3 , 858, 183, 927, 246, 256, 815, 924, 357, 992, 107, 413, 180, 75, 513, 426, 712, 938, 870, 938, 296, 651, 870, 389, 629, 901, 664, 877 , 620, 229, 816, 897, 458, 728, 969, 907, 459, 873, 968, 728, 459, 907, 783, 859, 300, 783, 924, 981, 79, 809, 23, 797, 503, 958, 653, 575, 910, 575, 592, 149, 858, 161, 711, 149, 858, 575, 994, 161, 974, 983, 994, 700, 221, 816, 407, 992, 407, 414, 815, 991, 216, 563, 698, 791, 664, 569, 634, 234, 816, 214, 522, 401, 73, 748, 270, 603 , 472,  64, 997, 856, 773,  63, 938,  63, 278, 877, 545, 127, 647, 41, 73,  92, 134, 538, 970, 396, 970, 739,  88, 409, 842, 954, 544, 785, 557,  44, 119, 984, 752, 587, 157, 765, 754, 784, 520, 500, 925, 778, 283, 970, 283, 815, 198, 532, 535, 576, 454, 984, 601, 968, 360, 229, 902, 1018, 829, 836, 754, 409, 278, 799, 914, 799, 876, 697, 565, 204, 157, 204, 46, 452, 709, 975, 214, 689, 711, 951, 199, 901, 794, 492, 1022, 225, 909, 980, 178, 988, 86, 414, 601, 912, 34, 192, 635, 605 , 227, 877, 408 , 409, 860, 134, 647, 739, 278, 877, 88, 739,  88, 134, 914, 561, 154, 756, 344, 894, 735, 576, 3, 684, 767, 217, 749, 281, 562, 684, 852, 887, 102, 144, 198, 380,  48, 156, 770, 156, 506, 1000, 215, 1000, 670, 739 , 782, 739, 364, 739, 303, 739, 938,  64, 994, 394, 1008,  92, 881, 394, 925, 371, 372, 905, 766, 134, 647, 1020, 860, 127, 860, 739, 914, 739, 914, 739, 938, 836, 278, 836, 938, 134, 647, 409, 519, 739, 303, 739, 914, 739,  88, 739, 88, 739, 741, 409, 425
#]
#ref = [x - 1 for x in ref]


#pred = [
#409, 278, 739, 278, 739,  741 ,  739 , 88, 739, 278, 739, 278, 739 , 278, 739,  278 ,  739 , 88, 739,  88, 739, 278, 739,  88, 739,  88, 739,  88, 739, 278, 739 , 278, 739, 278, 739, 303, 739, 278, 739, 278, 739, 88, 739,  88, 134, 278, 134, 278, 739, 278, 739,  88, 739,  88, 739,  88, 739, 278, 134, 278, 476, 278, 739, 278, 476, 278, 739, 278, 739,  88, 739,  88, 464,   278, 739, 303, 739, 303, 134, 278, 340, 278, 636, 975, 434, 653, 464,   201, 149, 653, 149, 653, 149, 349, 161, 653, 149, 349, 238, 985, 240, 178, 556, 401, 865, 648, 981, 193, 75, 668, 907, 779, 277, 679, 866, 303,  63, 278, 739, 278, 739, 278, 739, 739, 1015,  39, 497, 653, 575,   653, 161, 647, 149, 748, 149, 647,  54, 748, 1012, 686, 856, 994, 877,  88, 739,  88, 739,  88, 780, 773,  799 ,  1024, 538, 201, 637, 948, 582, 196, 767, 656, 585, 68, 13, 36, 253, 778, 940, 220, 198, 300, 987, 337, 973, 703, 81, 73, 992, 706, 954, 1015, 673, 368 , 677, 352, 149, 416, 149, 134, 149, 653, 149, 653, 765, 418, 644, 713, 614, 816, 524, 956, 630, 278, 26,  207 ,  538 , 422, 177, 1024, 177,  5 , 799, 1003, 410, 743, 799, 876, 500, 201, 538,   1003, 74, 38, 92, 278, 556, 525, 644, 73, 414, 664, 349, 601, 887, 709, 587, 677, 571, 1003, 765, 813,  26, 422, 489, 242, 255, 5, 146, 1024, 146, 1024, 146, 365,  149 ,  365 , 146, 647, 146, 647, 149, 647, 149,   647, 149, 647, 149, 647, 710, 975, 134, 994, 866, 994, 144, 437, 192, 918, 329,  68, 345, 300, 938, 770 , 695, 452, 576, 68, 924, 535, 415, 525, 922, 93, 922, 601, 922, 499, 812, 43, 229, 484, 739 , 766, 63, 278, 409,  88, 409, 278, 835 , 303, 970, 821, 408, 357, 480, 534, 728, 667, 808, 1018, 466, 488, 728, 447, 907, 1018, 907, 850, 728, 832, 652, 532, 907, 389, 345, 665, 466, 382, 808, 773, 752, 503, 345 ,  44, 374, 416, 149, 750 , 575, 832, 161, 647 , 161, 653, 149, 349, 149, 647, 149, 975, 464, 201, 538, 975, 780, 368, 866, 994, 739 , 278, 739, 278, 739, 303, 739, 914, 739, 278, 739, 278, 739, 278, 739, 278, 739, 303, 739,   278, 739, 88, 739, 278, 739, 278, 739,  88,  739 ,  278 , 134, 649, 739, 278, 739, 88, 739, 278, 739,  88, 739, 303, 739, 914, 739,  88, 739,  88, 739, 88, 739 , 278, 739, 278, 739,  88, 880,  88, 739, 278, 739, 278, 134, 278, 396, 278, 396, 201, 888, 647, 458, 724, 864, 986, 582, 77, 199, 601, 796, 46, 281, 332, 644, 535, 467, 318, 505, 933, 756, 193, 34, 438, 917, 23, 725, 396, 1020,  88, 538,  58, 104, 1003, 678, 416, 238, 647, 177, 741, 340, 994, 739, 278, 409, 278, 710, 748, 161, 649, 439,  88, 177, 1024, 87, 994, 121, 294, 938, 533, 589, 697, 466, 473, 24, 472, 433, 494, 781, 278, 409, 278, 739,  88, 739,  88, 500, 498, 64, 563, 620, 899, 146, 647, 149, 975, 575, 647, 464, 748, 134, 994, 748, 319, 1023, 815, 929, 360, 785, 940, 292, 963, 1021, 940, 370, 864, 34, 504, 502, 940, 401, 632, 502, 506, 199, 336, 217, 601, 281, 380, 659, 664, 739, 652, 739 , 987, 739, 914,  63, 88, 134 , 278,  92, 861, 941, 1024, 149, 1024, 149, 349, 149, 472, 434, 201, 876, 776, 338, 395, 809, 68, 34, 525, 943, 956, 968, 504, 792, 544,  605 ,  694 , 725, 766, 1018,  88, 1018, 303, 739, 278, 739, 278, 739,   278,   739,  88, 739, 88, 739, 278,  134 ,  278 , 1009, 862, 192, 940, 256, 940, 752, 68, 1001, 454, 1001, 152, 192, 963, 950, 493, 897, 260, 988, 493, 945, 266, 816, 921, 466, 386, 605, 922,  1018, 115, 781, 278, 409,   88 , 26,  88, 146, 242, 146, 1024, 255, 365, 255,  39, 104, 520, 277, 520, 571, 825, 408, 684, 503, 660, 907, 499, 152, 352, 466, 812, 503, 832, 531, 227, 652, 440, 137, 986, 652, 208, 688, 821, 256, 450, 907, 431, 24, 294, 503, 917, 978, 438, 584, 23, 374, 850, 149, 832, 161, 653, 161, 1024, 149, 37, 149, 647, 464, 647, 149, 975, 26,  39,  26, 975,  877 ,  994 , 739,  88, 739,  88, 739, 303, 739,   88 ,  739 , 278, 739,  88, 739,  88, 739, 303, 739, 278, 739, 278, 739 , 278, 739,  88, 739, 88, 739, 278, 134, 278, 739, 278, 739, 741, 739, 88, 739, 303, 134, 278, 739, 278, 739,   88, 739, 303, 739, 278, 739, 303, 739, 741, 678, 633, 127, 278, 739, 88, 678, 364,   60, 154, 652, 152, 312, 825, 858, 183, 927, 246, 256, 815, 924, 357, 992, 107, 413, 180, 75, 513, 426, 712, 938, 870, 938, 193, 651, 870, 227, 867, 901, 378, 1020, 620, 229, 816, 897, 458, 593, 712, 907, 219, 503, 718, 728, 459, 907, 783, 859, 839, 783, 924, 981, 79, 809, 23, 797, 333, 958, 653, 575, 159, 575, 592, 575, 994, 149, 647, 149, 647, 575, 647, 464, 653, 983, 994, 275, 684, 714,  68, 970, 407, 414, 815, 100, 216, 563, 698, 791, 664, 791, 593, 401, 195, 214, 522, 401, 73, 748, 807, 1009, 503, 416, 217, 780, 409, 781, 278, 409, 278, 739,  88, 780,  44, 96, 95, 324, 321, 500, 630,  92,  38, 134, 278, 134, 278, 954, 544, 785, 557, 669, 886, 984, 752, 587, 157, 765, 365, 784, 520, 500, 925, 500,  50, 970, 283, 815, 198, 532, 535, 576, 454, 984, 601, 308, 360, 630, 670, 1018, 829,  63, 822, 396, 303, 799, 647, 822, 876, 132, 939, 204, 157, 204, 46, 289, 305, 975, 214, 689, 711, 951, 199, 901, 741, 492, 602 , 605, 565, 873, 652, 644, 79, 414, 601, 912, 34, 192, 635, 1020, 227,  63, 1016,  63, 278, 409,  88, 739,  88, 739, 88, 739, 303, 739,  88, 561, 154, 756, 344, 349, 823, 576, 3, 684, 767, 310, 749, 281, 562, 684, 601, 887, 102, 144, 198, 380, 634, 156, 770, 897,  1 , 433 , 595, 431 , 408, 1020, 364, 605, 278, 409, 278, 739, 278, 282, 861, 394, 962 , 394, 985, 394, 185, 371, 372,  53, 742, 739,  88, 739 , 303, 739, 278, 739, 278, 739,  88, 739,  88, 739,  88, 739, 303, 739, 278, 739, 278, 739,  88, 739,  88, 739, 278, 739, 88, 739, 278, 739,  88
#]
#pred = [x - 1 for x in pred]


import torch

ref = torch.tensor(ref).reshape(-1, 2).movedim(-1, -2)[None, None]
ref_audio_values = model.decode(ref, [None])[0]

print(ref_audio_values)

print(len(ref))
print(len(pred))


pred = torch.tensor(pred).reshape(-1, 2).movedim(-1, -2)[None, None]
pred_audio_values = model.decode(pred, [None])[0]



from utils import play_waveform

play_waveform(ref_audio_values.detach().cpu()[0], 24000, interactive=True, output_file="ref.wav")
play_waveform(pred_audio_values.detach().cpu()[0], 24000, interactive=True, output_file="pred.wav")